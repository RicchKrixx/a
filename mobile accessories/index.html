<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>BizMAX | Mobile Accessories</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: Arial, sans-serif;
      background: lightblue;
    }
    header {
      width: 100%;
      padding: 24px;
      border-radius: 16px;
      backdrop-filter: blur(25px);
      color: white;
      display: flex;
      flex-direction: column;
      align-items: center;
      font-weight: bold;
      background-size: cover;
      margin-bottom: 10px;
    }
    h3 {
      color: black;
    }
    .cart-icon {
      position: fixed;
      font-size: 35px;
      text-decoration: none;
      color: white;
      right: 17px;
      top: 20px;
    }
    #cartCount {
      position: absolute;
      top: -8px;
      right: -12px;
      background: red;
      color: white;
      font-size: 14px;
      font-weight: bold;
      border-radius: 50%;
      padding: 2px 6px;
    }
    .products {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      gap: 16px;
      padding: 16px;
    }
    .product {
      padding: 5px;
      border-radius: 35px;
      text-align: center;
      background: darkcyan;
      color: white;
      font-weight: bold;
      box-shadow: 0 0 10px cyan;
    }
    .product img {
      width: 100%;
      height: 160px;
      object-fit: cover;
      border-radius: 30px;
    }
    .product-name {
      font-size: 18px;
      margin-top: 0;
      margin-bottom: 5px;
      color: black;
    }
    .product-price {
      font-size: 15px;
    }
    .add-btn {
      background: cyan;
      color: white;
      padding: 8px 12px;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      margin-top: 5px;
      font-weight: bold;
    }
    .add-btn:hover {
      background: #008b8b;
    }
    .glow {
      animation: brightGlow 1.5s infinite ease-in-out;
      color: cyan;
      text-shadow: 0 0 5px #0ff, 0 0 10px #0ff, 0 0 15px #0ff;
    }
    @keyframes brightGlow {
      0%, 100% {
        text-shadow: 0 0 5px #0ff, 0 0 10px #0ff, 0 0 15px #0ff;
      }
      50% {
        text-shadow: 0 0 15px #0ff, 0 0 25px #0ff, 0 0 35px #0ff;
      }
    }
    @keyframes shake {
      0% { transform: translateX(0); }
      20% { transform: translateX(-4px); }
      40% { transform: translateX(4px); }
      60% { transform: translateX(-4px); }
      80% { transform: translateX(4px); }
      100% { transform: translateX(0); }
    }
    .shake {
      animation: shake 0.4s ease;
    }
    footer {
      color: white;
      padding: 15px;
      margin-top: 15px;
      width: 100%;
      border-radius: 16px;
      background: darkcyan;
      margin: 10px auto;
      font-weight: bold;
      box-shadow: 0 0 10px cyan;
      display: flex;
      align-content: center;
      justify-content: center;
    }
  </style>
</head>
<body>
  <header>
    <h1>BixMAX</h1>
    <h3>All-in-One Online Shop</h3>
    <a href="/cart/" class="cart-icon glow" id="cartIcon">ðŸ›’<span id="cartCount">0</span></a>
  </header>
<div style="padding: 10px; text-align: center;">
  <input type="text" id="searchInput" placeholder="Search groceries..." style="width: 90%; padding: 10px; font-size: 16px; border-radius: 12px; border: none; outline: none; box-shadow: 0 0 5px cyan;">
</div>
  <div class="products" id="mobileContainer">Loading...</div>
<p id="notFoundMessage" style="display:none; text-align:center; margin-top:1rem; font-size:1.2rem; color:gray;">
  ðŸ˜¢ No matching products found.
</p>  
  <footer>&copy; BixMAX 2025. All rights reserved.</footer>  

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.11.1/firebase-app.js";
  import { getFirestore, collection, onSnapshot } from "https://www.gstatic.com/firebasejs/10.11.1/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyCU4kWk-l7FDF4AJDk-WbA2A4GRvVWFaOw",
    authDomain: "bizmax-data.firebaseapp.com",
    projectId: "bizmax-data",
    storageBucket: "bizmax-data.appspot.com",
    messagingSenderId: "589563081184",
    appId: "1:589563081184:web:bb7fd79ccad222e87197ae",
    measurementId: "G-DWR05P5WGR"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  const container = document.getElementById("mobileContainer");
  const notFoundMessage = document.getElementById("notFoundMessage");
  let mobileItems = []; // âœ… Declare globally for use in search

  const renderMobile = (items) => {
    container.innerHTML = ""; // Clear current items
    items.forEach((item) => {
      const product = document.createElement("div");
      product.className = "product";
      product.innerHTML = `
        <img src="${item.image}" alt="${item.name}">
        <div class="product-name">${item.name}</div>
        <div class="product-price">GHâ‚µ ${item.price}</div>
        <button class="add-to-cart" data-id="${item.id}">Add to Cart</button>
      `;
      container.appendChild(product);
    });
  };

  // âœ… Load data from Firestore and render
  onSnapshot(collection(db, "Mobile"), (snapshot) => {
    const items = [];
    snapshot.forEach((doc) => {
      const data = doc.data();
      items.push({
        id: doc.id,
        name: data.name,
        price: data.price,
        image: data.image,
      });
    });

    mobileItems = items;
    localStorage.setItem("Mobile", JSON.stringify(items));
    renderMobile(items);
  });

  // âœ… Live search logic
  const searchInput = document.getElementById('searchInput');
  searchInput.addEventListener('input', () => {
    const query = searchInput.value.trim().toLowerCase();
    const cached = localStorage.getItem("Mobile");

    if (!cached) return;

    const items = JSON.parse(cached);

    const filtered = items.filter(item =>
      item.name.toLowerCase().includes(query) ||
      item.price.toString().includes(query)
    );

    if (filtered.length > 0) {
      notFoundMessage.style.display = "none";
      renderMobile(filtered);
    } else {
      container.innerHTML = "";
      notFoundMessage.style.display = "block";
    }

    if (!query) {
      notFoundMessage.style.display = "none";
      renderMobile(items);
    }
  });
</script>
</body>
</html>
