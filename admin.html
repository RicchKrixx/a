<!DOCTYPE html>
<html>
<head>
  <title>Checkout</title>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
  <style>
    body {
      font-family: Arial;
      padding: 20px;
      background: #f0f0f0;
    }
    .box {
      background: white;
      padding: 20px;
      border-radius: 12px;
      max-width: 500px;
      margin: auto;
      box-shadow: 0 0 15px rgba(0,0,0,0.1);
    }
    input, textarea, button {
      width: 100%;
      padding: 10px;
      margin: 10px 0;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
    button {
      background: #1976d2;
      color: white;
      font-weight: bold;
    }
  </style>
</head>
<body>

<div class="box">
  <h2>Checkout Page</h2>

  <h3>Order Summary</h3>
  <div id="order-summary"></div>
  <h3>Total: $<span id="total">0.00</span></h3>

  <form id="checkoutForm">
    <input type="text" id="name" placeholder="Full Name" required>
    <input type="tel" id="phone" placeholder="Phone Number" required>
    <textarea id="address" placeholder="Delivery Address" required></textarea>
    <button type="submit">Place Order</button>
  </form>

  <div id="success" style="color: green; display:none;">Order placed successfully!</div>
</div>

<script>
  // ðŸ”¥ Initialize Firebase
 const firebaseConfig = {
  apiKey: "AIzaSyDkU07SZ8xmlg8Lo4TGBQQDISh62HRCYF0",
  authDomain: "bixmax-orders.firebaseapp.com",
  projectId: "bixmax-orders",
  storageBucket: "bixmax-orders.firebasestorage.app",
  messagingSenderId: "880588466149",
  appId: "1:880588466149:web:40eef55fe3aab891da710c",
  measurementId: "G-9MR5446XT7"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const analytics = getAnalytics(app);

  // ðŸ›’ Load Cart
  function loadCartSummary() {
    const cart = JSON.parse(localStorage.getItem('cart')) || [];
    const summaryDiv = document.getElementById('order-summary');
    const totalSpan = document.getElementById('total');
    summaryDiv.innerHTML = '';
    let grandTotal = 0;

    cart.forEach(item => {
      const itemTotal = item.price * item.quantity;
      grandTotal += itemTotal;
      const div = document.createElement('div');
      div.innerHTML = ${item.name} (${item.quantity} x $${item.price}) = $${itemTotal.toFixed(2)};
      summaryDiv.appendChild(div);
    });

    totalSpan.textContent = grandTotal.toFixed(2);
    return { cart, total: grandTotal };
  }

  const { cart, total } = loadCartSummary();

  // ðŸ“¤ Submit Order
  document.getElementById('checkoutForm').addEventListener('submit', function(e) {
    e.preventDefault();
    const name = document.getElementById('name').value.trim();
    const phone = document.getElementById('phone').value.trim();
    const address = document.getElementById('address').value.trim();

    db.collection('orders').add({
      name,
      phone,
      address,
      cart,
      total,
      timestamp: new Date()
    }).then(() => {
      document.getElementById('success').style.display = 'block';
      localStorage.removeItem('cart');
    }).catch(err => {
      alert("Error placing order: " + err);
    });
  });
</script>

</body>
</html>
